import React, { ReactNode, useEffect, useRef, useState } from "react";
import { Swiper, SwiperSlide } from "swiper/react";
import "swiper/css";
import "swiper/css/pagination";
import { Pagination } from "swiper/modules";
import styles from "./ProfileCardSwiper.module.css";
import { SwiperRef } from "swiper/react";
import SlideCard from "../SlideCard/SlideCard";
import ProfileCard from "../ProfileCard/ProfileCard";
import HashButtonGroup from "../HashButtonGroup/HashButtonGroup";

export type HaenyeosProfileInfo = {
  title: string;
  description: string;
  image: string;
  id: number;
  name: string;
  group: string;
};

export default function ProfileCardSwiper() {
  const [haenyeos, setHaenyeos] = useState<HaenyeosProfileInfo[]>([]);

  const swiperRef = useRef<SwiperRef | null>(null);

  useEffect(() => {
    fetch("/data/haenyeos.json")
      .then((response) => {
        if (!response.ok) {
          throw new Error("Network response was not ok");
        }
        return response.json();
      })
      .then((data) => {
        setHaenyeos(data);
      })
      .catch((error) => {
        console.error(
          "There was a problem with the fetch operation:",
          error.message
        );
      });
  }, []);

  const onClick = (id: number) => {
    swiperRef.current?.swiper?.slideTo(id);
  };

  return (
    <div className="">
      <HashButtonGroup onClick={onClick} />
      <div className={styles.swiperContainer}>
        <Swiper
          className={`mySwiper ${styles.swiper}`}
          spaceBetween={30}
          centeredSlides={true}
          pagination={{
            clickable: true,
          }}
          ref={swiperRef}
          modules={[Pagination]}
        >
          {haenyeos &&
            groupingHaenyeosProfileInfo(haenyeos).map((h, index) => (
              <SwiperSlide key={index}>
                <SlideCard key={index}>
                  <>
                    {generateH4(h[0].group, getSVG(h[0].group))}
                    <ProfileCard
                      image={h[0].image}
                      title={
                        <span
                          dangerouslySetInnerHTML={{
                            __html: h[0].title.replace(
                              h[0].name,
                              `<span style="color: var(--blue-main);">${h[0].name}</span>`
                            ),
                          }}
                        />
                      }
                      description={h[0].description}
                      key={h[0].id}
                      name={h[0].name}
                    />
                    <ProfileCard
                      image={h[1].image}
                      title={
                        <span
                          dangerouslySetInnerHTML={{
                            __html: h[1].title.replace(
                              h[1].name,
                              `<span style="color: var(--blue-main);">${h[1].name}</span>`
                            ),
                          }}
                        />
                      }
                      description={h[1].description}
                      key={h[1].id}
                      name={h[1].name}
                    />
                  </>
                </SlideCard>
              </SwiperSlide>
            ))}
        </Swiper>
      </div>
    </div>
  );
}

function groupingHaenyeosProfileInfo(data: HaenyeosProfileInfo[]) {
  const groupedData = [];
  for (let i = 0; i < data.length; i += 2) {
    groupedData.push(data.slice(i, i + 2));
  }

  return groupedData;
}

function generateH4(text: string, svg: ReactNode) {
  return (
    <h4 className={`h4 ${styles.title}`}>
      {text}
      {svg}
    </h4>
  );
}

function getSVG(group: string) {
  switch (group) {
    case "이제 막 자라나기 시작한 새싹":
      return (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
        >
          <path
            d="M19.2572 14.1628C18.358 14.7094 17.3253 14.9968 16.2731 14.9934C15.3916 14.9864 14.5201 14.8061 13.7081 14.4628C13.0824 15.3462 12.7475 16.4027 12.75 17.4853V20.25C12.7502 20.3528 12.7293 20.4546 12.6885 20.549C12.6478 20.6434 12.5881 20.7284 12.5131 20.7987C12.4381 20.869 12.3494 20.9232 12.2526 20.9578C12.1558 20.9925 12.0529 21.0068 11.9503 21C11.7575 20.9832 11.5782 20.8942 11.4483 20.7507C11.3185 20.6073 11.2476 20.4201 11.25 20.2266V19.0603L7.62937 15.4397C7.09115 15.6405 6.52194 15.7455 5.9475 15.75C5.15669 15.752 4.38069 15.5356 3.705 15.1247C1.66219 13.8834 0.562501 11.0269 0.775313 7.48031C0.786028 7.29683 0.863744 7.12367 0.993707 6.99371C1.12367 6.86374 1.29683 6.78603 1.48031 6.77531C5.02688 6.56625 7.88344 7.66219 9.12094 9.705C9.60714 10.5057 9.8194 11.4429 9.72562 12.375C9.7198 12.4472 9.69317 12.5162 9.64897 12.5736C9.60477 12.631 9.54489 12.6744 9.47657 12.6985C9.40824 12.7226 9.3344 12.7264 9.26397 12.7094C9.19354 12.6924 9.12953 12.6554 9.07969 12.6028L7.27969 10.7184C7.13789 10.5837 6.94908 10.5097 6.75351 10.5122C6.55794 10.5147 6.37108 10.5935 6.23278 10.7318C6.09448 10.8701 6.01567 11.057 6.01317 11.2526C6.01067 11.4481 6.08466 11.637 6.21937 11.7788L11.2706 16.9584C11.2762 16.8853 11.2828 16.8122 11.2903 16.74C11.4543 15.3495 12.0679 14.0505 13.0378 13.0406L17.7806 8.02875C17.9214 7.88814 18.0005 7.69739 18.0006 7.49846C18.0006 7.29952 17.9217 7.1087 17.7811 6.96797C17.6405 6.82724 17.4497 6.74813 17.2508 6.74804C17.0519 6.74795 16.861 6.82689 16.7203 6.9675L12.1266 11.8256C12.0806 11.8743 12.0224 11.9098 11.958 11.9284C11.8937 11.947 11.8255 11.9481 11.7607 11.9314C11.6958 11.9148 11.6366 11.881 11.5891 11.8338C11.5417 11.7865 11.5078 11.7273 11.4909 11.6625C11.0466 10.0238 11.2425 8.3925 12.0909 6.99188C13.7653 4.22813 17.6616 2.74875 22.5141 3.03375C22.6975 3.04447 22.8707 3.12218 23.0007 3.25214C23.1306 3.38211 23.2083 3.55527 23.2191 3.73875C23.5003 8.59219 22.0209 12.4884 19.2572 14.1628Z"
            fill="#48BBB0"
          />
        </svg>
      );
    case "드디어 나도 1년차! 해녀 어린이":
      return (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
        >
          <path
            d="M12.5775 2.25937C12.5119 2.25594 12.4465 2.2698 12.3879 2.29959C12.3293 2.32937 12.2796 2.37402 12.2437 2.42906C11.2781 3.88875 11.25 5.23031 11.25 5.25C11.2504 5.36161 11.2758 5.47172 11.3242 5.57229C11.3726 5.67286 11.4428 5.76136 11.5298 5.83133C11.6167 5.90131 11.7182 5.95099 11.8268 5.97677C11.9354 6.00254 12.0484 6.00375 12.1575 5.98031C12.3278 5.93952 12.4792 5.84205 12.5869 5.7039C12.6945 5.56576 12.752 5.39513 12.75 5.22C12.7536 5.11741 12.7782 5.01666 12.8223 4.92396C12.8664 4.83127 12.929 4.74862 13.0064 4.68113C13.0837 4.61363 13.1741 4.56273 13.2719 4.53157C13.3697 4.50042 13.4729 4.48967 13.575 4.5C13.7632 4.52185 13.9366 4.61295 14.0613 4.75556C14.1861 4.89818 14.2533 5.08211 14.25 5.27156C14.2466 5.8683 14.0064 6.43926 13.582 6.85885C13.1577 7.27843 12.5841 7.51226 11.9873 7.50891C11.3906 7.50555 10.8196 7.26528 10.4 6.84095C9.98046 6.41662 9.74663 5.84299 9.74998 5.24625C9.74998 5.18719 9.75842 4.23562 10.26 2.99625C10.2854 2.93283 10.293 2.86367 10.2819 2.79625C10.2709 2.72883 10.2417 2.6657 10.1974 2.61369C10.1531 2.56167 10.0954 2.52275 10.0306 2.50111C9.96581 2.47948 9.89633 2.47596 9.82967 2.49094C7.61986 2.99854 5.65555 4.25931 4.27374 6.05696C2.89193 7.85462 2.17875 10.0771 2.25655 12.3431C2.43748 17.505 6.6778 21.6562 11.8425 21.7406C14.3902 21.7796 16.852 20.8198 18.7009 19.0664C20.5498 17.3131 21.6388 14.9056 21.7349 12.3594C21.8309 9.81312 20.9264 7.33045 19.2149 5.44277C17.5034 3.5551 15.1209 2.41243 12.5775 2.25937ZM7.49998 11.9916C7.49998 11.7691 7.56596 11.5516 7.68958 11.3665C7.8132 11.1815 7.9889 11.0373 8.19447 10.9522C8.40003 10.867 8.62623 10.8448 8.84446 10.8882C9.06269 10.9316 9.26314 11.0387 9.42048 11.1961C9.57781 11.3534 9.68496 11.5539 9.72837 11.7721C9.77178 11.9903 9.7495 12.2165 9.66435 12.4221C9.5792 12.6276 9.43501 12.8033 9.25 12.927C9.06499 13.0506 8.84749 13.1166 8.62498 13.1166C8.32662 13.1166 8.04047 12.998 7.82949 12.7871C7.61851 12.5761 7.49998 12.2899 7.49998 11.9916ZM15.0253 17.1262C14.1177 17.6921 13.0695 17.992 12 17.992C10.9304 17.992 9.88231 17.6921 8.97467 17.1262C8.80634 17.0201 8.68708 16.8514 8.64313 16.6573C8.59917 16.4632 8.63413 16.2596 8.7403 16.0912C8.84647 15.9229 9.01516 15.8037 9.20926 15.7597C9.40336 15.7158 9.60697 15.7507 9.7753 15.8569C10.4433 16.2715 11.2138 16.4911 12 16.4911C12.7862 16.4911 13.5567 16.2715 14.2247 15.8569C14.308 15.8043 14.4009 15.7687 14.498 15.752C14.5951 15.7353 14.6946 15.7379 14.7907 15.7597C14.8868 15.7815 14.9777 15.822 15.0582 15.8788C15.1386 15.9357 15.2071 16.0079 15.2597 16.0912C15.3122 16.1746 15.3479 16.2675 15.3646 16.3646C15.3812 16.4617 15.3786 16.5612 15.3568 16.6573C15.3351 16.7534 15.2946 16.8443 15.2377 16.9247C15.1808 17.0052 15.1086 17.0737 15.0253 17.1262ZM15.375 13.1166C15.1525 13.1166 14.935 13.0506 14.75 12.927C14.565 12.8033 14.4208 12.6276 14.3356 12.4221C14.2505 12.2165 14.2282 11.9903 14.2716 11.7721C14.315 11.5539 14.4222 11.3534 14.5795 11.1961C14.7368 11.0387 14.9373 10.9316 15.1555 10.8882C15.3737 10.8448 15.5999 10.867 15.8055 10.9522C16.0111 11.0373 16.1868 11.1815 16.3104 11.3665C16.434 11.5516 16.5 11.7691 16.5 11.9916C16.5 12.2899 16.3815 12.5761 16.1705 12.7871C15.9595 12.998 15.6734 13.1166 15.375 13.1166Z"
            fill="#FECC77"
          />
        </svg>
      );
    case "어린 시절부터 바다와 함께하다":
      return (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="25"
          height="24"
          viewBox="0 0 25 24"
          fill="none"
        >
          <path
            d="M16.7556 7.11937C16.7556 7.34188 16.6897 7.55939 16.5661 7.74439C16.4424 7.9294 16.2667 8.07359 16.0612 8.15874C15.8556 8.24389 15.6294 8.26617 15.4112 8.22276C15.1929 8.17935 14.9925 8.0722 14.8352 7.91487C14.6778 7.75754 14.5707 7.55708 14.5273 7.33885C14.4839 7.12062 14.5061 6.89442 14.5913 6.68886C14.6764 6.48329 14.8206 6.30759 15.0056 6.18397C15.1906 6.06035 15.4081 5.99437 15.6306 5.99437C15.929 5.99437 16.2152 6.1129 16.4261 6.32388C16.6371 6.53486 16.7556 6.82101 16.7556 7.11937ZM20.4935 14.7131C18.5472 17.1853 15.445 18.5325 11.2675 18.7228L9.20502 23.5434C9.14728 23.6793 9.05074 23.795 8.9275 23.8762C8.80427 23.9575 8.6598 24.0005 8.51221 24H8.4644C8.30985 23.9903 8.16209 23.933 8.0414 23.836C7.92071 23.739 7.83301 23.607 7.79034 23.4581L6.4019 18.5972L1.54377 17.2059C1.3945 17.164 1.26188 17.0768 1.16419 16.9564C1.06649 16.836 1.00851 16.6883 0.998233 16.5336C0.987953 16.3789 1.02588 16.2248 1.10678 16.0925C1.18769 15.9603 1.30761 15.8563 1.45002 15.795L6.27159 13.7325C6.45909 9.55406 7.81002 6.45187 10.2831 4.50656C14.3341 1.31906 20.1185 2.36625 21.2369 2.60812C21.5187 2.66901 21.7769 2.80979 21.9808 3.01363C22.1846 3.21747 22.3254 3.47573 22.3863 3.7575C22.6338 4.875 23.6819 10.665 20.4935 14.7187V14.7131ZM20.9247 4.07344C19.9206 3.85594 14.7372 2.91187 11.215 5.68406C10.771 6.03453 10.3675 6.43357 10.0122 6.87375C9.97623 7.36382 10.0477 7.85583 10.2216 8.31541C10.3955 8.775 10.6677 9.19106 11.0191 9.53452C11.3705 9.87799 11.7927 10.1406 12.2561 10.3039C12.7196 10.4673 13.2131 10.5275 13.7022 10.4803C13.8122 10.4699 13.9231 10.4839 14.027 10.5213C14.1309 10.5586 14.2253 10.6185 14.3034 10.6966C14.3815 10.7747 14.4414 10.8691 14.4788 10.973C14.5162 11.077 14.5301 11.1879 14.5197 11.2978C14.4725 11.7871 14.5327 12.2808 14.6962 12.7444C14.8597 13.208 15.1224 13.6302 15.4661 13.9817C15.8098 14.3331 16.2261 14.6053 16.6859 14.779C17.1457 14.9528 17.6379 15.0241 18.1281 14.9878C18.567 14.633 18.9648 14.2302 19.3141 13.7869C22.0863 10.2647 21.1422 5.07937 20.9247 4.07531V4.07344Z"
            fill="#227C9E"
          />
        </svg>
      );
    case "시작은 서로 다르지만, 끝은 오직 바다":
      return (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
        >
          <path
            d="M23.25 9.75C23.2501 9.90579 23.2017 10.0577 23.1114 10.1848C23.0212 10.3118 22.8937 10.4075 22.7466 10.4587L6 16.2834V20.25C6 20.4489 5.92098 20.6397 5.78033 20.7803C5.63968 20.921 5.44891 21 5.25 21C5.05109 21 4.86032 20.921 4.71967 20.7803C4.57902 20.6397 4.5 20.4489 4.5 20.25V3.75C4.49993 3.63028 4.52852 3.51229 4.58338 3.40589C4.63823 3.29948 4.71777 3.20775 4.81532 3.13837C4.91288 3.06899 5.02563 3.02397 5.14415 3.00707C5.26266 2.99017 5.3835 3.00189 5.49656 3.04125L22.7466 9.04125C22.8937 9.09246 23.0212 9.18823 23.1114 9.31524C23.2017 9.44225 23.2501 9.59421 23.25 9.75Z"
            fill="#FF6C74"
          />
        </svg>
      );
    default:
      throw new Error("알 수 없는 타입입니다.");
  }
}
